# =============================================================================
# Security Quality Gate Configuration
# Personaliza los umbrales de vulnerabilidades según tu política de seguridad
# =============================================================================

# Umbrales de vulnerabilidades
MAX_CRITICAL=0          # Máximo número de vulnerabilidades críticas permitidas
MAX_HIGH=5              # Máximo número de vulnerabilidades altas permitidas  
MAX_MEDIUM=15           # Máximo número de vulnerabilidades medias permitidas

# Políticas de bloqueo
BLOCK_ON_SECRETS=false         # Bloquear si se encuentran secretos (false para VAmPI)
BLOCK_ON_CRITICAL_DEPS=true    # Bloquear si hay dependencias críticas vulnerables
FAIL_ON_CRITICAL=true          # Fallar pipeline en vulnerabilidades críticas
FAIL_ON_HIGH=false             # Fallar pipeline en vulnerabilidades altas

# Configuración específica por herramienta
BANDIT_MAX_HIGH=3              # Máximo de issues altos en Bandit
SEMGREP_MAX_ERROR=2            # Máximo de errores en Semgrep
TRIVY_IGNORE_UNFIXED=true      # Ignorar vulnerabilidades sin fix disponible

# Configuración de entorno
ENABLE_NOTIFICATIONS=true      # Habilitar notificaciones
SLACK_WEBHOOK_URL=""           # URL de webhook para Slack (opcional)
EMAIL_RECIPIENTS=""            # Emails para notificaciones (opcional)

# Configuración de reportes
GENERATE_HTML_REPORT=true      # Generar reporte HTML
GENERATE_PDF_REPORT=false      # Generar reporte PDF
UPLOAD_TO_S3=false             # Subir reportes a S3

# =============================================================================
# Configuraciones por Ambiente
# =============================================================================

# Desarrollo (más permisivo)
if [[ "$ENVIRONMENT" == "development" ]]; then
    MAX_CRITICAL=1
    MAX_HIGH=10
    MAX_MEDIUM=25
    BLOCK_ON_SECRETS=false
    FAIL_ON_HIGH=false
fi

# Staging (intermedio)
if [[ "$ENVIRONMENT" == "staging" ]]; then
    MAX_CRITICAL=0
    MAX_HIGH=5
    MAX_MEDIUM=15
    BLOCK_ON_SECRETS=true
    FAIL_ON_HIGH=true
fi

# Producción (más estricto)
if [[ "$ENVIRONMENT" == "production" ]]; then
    MAX_CRITICAL=0
    MAX_HIGH=2
    MAX_MEDIUM=8
    BLOCK_ON_SECRETS=true
    FAIL_ON_HIGH=true
    TRIVY_IGNORE_UNFIXED=false
fi